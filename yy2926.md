yy2926
================
Yuxin
2018.12.9

``` r
library(broom)
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
library(tidyverse)
```

    ## -- Attaching packages ----------------------------------------------------------------------------------------------------------------------------------------- tidyverse 1.2.1 --

    ## √ ggplot2 3.0.0     √ readr   1.1.1
    ## √ tibble  1.4.2     √ purrr   0.2.5
    ## √ tidyr   0.8.1     √ stringr 1.3.1
    ## √ ggplot2 3.0.0     √ forcats 0.3.0

    ## -- Conflicts -------------------------------------------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(patchwork)
library("leaps")
library(faraway)
library(boot)
```

    ## 
    ## Attaching package: 'boot'

    ## The following objects are masked from 'package:faraway':
    ## 
    ##     logit, melanoma

``` r
library(ggplot2)
library("gridExtra")
```

    ## 
    ## Attaching package: 'gridExtra'

    ## The following object is masked from 'package:dplyr':
    ## 
    ##     combine

``` r
raw_data <- read_csv("./Data/Cancer_Registry.csv")
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double(),
    ##   avgDeathsPerYear = col_integer(),
    ##   medIncome = col_integer(),
    ##   popEst2015 = col_integer(),
    ##   binnedInc = col_character(),
    ##   Geography = col_character()
    ## )

    ## See spec(...) for full column specifications.

``` r
raw_data = janitor::clean_names(raw_data)
raw_data1 = raw_data %>% 
  select(-binned_inc) %>% 
  separate(geography, c("county", "state"), sep = ",") %>% 
  mutate(county = as.factor(county), 
         state = as.factor(state),
         avg_ann_count = avg_ann_count / pop_est2015*100000) %>% 
  select(target_death_rate, avg_ann_count, everything())
```

``` r
sapply(raw_data1, function(x) sum(is.na(x)))
```

    ##          target_death_rate              avg_ann_count 
    ##                          0                          0 
    ##        avg_deaths_per_year             incidence_rate 
    ##                          0                          0 
    ##                 med_income                pop_est2015 
    ##                          0                          0 
    ##            poverty_percent              study_per_cap 
    ##                          0                          0 
    ##                 median_age            median_age_male 
    ##                          0                          0 
    ##          median_age_female                     county 
    ##                          0                          0 
    ##                      state         avg_household_size 
    ##                          0                          0 
    ##            percent_married             pct_no_hs18_24 
    ##                          0                          0 
    ##                pct_hs18_24          pct_some_col18_24 
    ##                          0                       2285 
    ##          pct_bach_deg18_24              pct_hs25_over 
    ##                          0                          0 
    ##        pct_bach_deg25_over        pct_employed16_over 
    ##                          0                        152 
    ##      pct_unemployed16_over       pct_private_coverage 
    ##                          0                          0 
    ## pct_private_coverage_alone      pct_emp_priv_coverage 
    ##                        609                          0 
    ##        pct_public_coverage  pct_public_coverage_alone 
    ##                          0                          0 
    ##                  pct_white                  pct_black 
    ##                          0                          0 
    ##                  pct_asian             pct_other_race 
    ##                          0                          0 
    ##     pct_married_households                 birth_rate 
    ##                          0                          0

``` r
## Choose possible variables for our model
raw_data2 = raw_data1 %>% 
  select(target_death_rate, incidence_rate, poverty_percent,  pct_bach_deg25_over, pct_unemployed16_over, pct_public_coverage_alone)
sapply(raw_data2, function(x) sum(is.na(x)))
```

    ##         target_death_rate            incidence_rate 
    ##                         0                         0 
    ##           poverty_percent       pct_bach_deg25_over 
    ##                         0                         0 
    ##     pct_unemployed16_over pct_public_coverage_alone 
    ##                         0                         0

``` r
## No missing values
```

``` r
## Visualization of predictors to find outliers
histogram1 = ggplot(raw_data2, aes(x  = raw_data2$target_death_rate)) + geom_histogram() + labs(title = "pct_target_death_rate")
histogram2 = ggplot(raw_data2, aes(x  = raw_data2$incidence_rate)) + geom_histogram() + labs(title = "pct_incidence_rate")
histogram3 = ggplot(raw_data2, aes(x  = raw_data2$poverty_percent)) + geom_histogram() + labs(title = "pct_poverty_percent")
histogram4 = ggplot(raw_data2, aes(x  = raw_data2$pct_bach_deg25_over)) + geom_histogram() + labs(title = "pct_pct_bach_deg25_over")
histogram5 = ggplot(raw_data2, aes(x  = raw_data2$pct_unemployed16_over)) + geom_histogram() + labs(title = "pct_unemployed16_over")
histogram6 = ggplot(raw_data2, aes(x  = raw_data2$pct_public_coverage_alone)) + geom_histogram() + labs(title = "pct_public_coverage_alone")
grid.arrange(histogram1, histogram2, histogram3, histogram4, histogram5,histogram6, ncol=2)
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

![](yy2926_files/figure-markdown_github/unnamed-chunk-5-1.png)

``` r
histogram1 = ggplot(raw_data2, aes(x  = raw_data2$target_death_rate)) + geom_point() + labs(title = "pct_target_death_rate")
```

``` r
## dotplot to make outliers more distinct
dot1 = ggplot(raw_data2, aes(x  = raw_data2$target_death_rate, y =raw_data2$target_death_rate)) + geom_point() + labs(title = "pct_target_death_rate")
dot2 = ggplot(raw_data2, aes(x  = raw_data2$incidence_rate, y =raw_data2$target_death_rate)) + geom_point() + labs(title = "pct_incidence_rate")
dot3 = ggplot(raw_data2, aes(x  = raw_data2$poverty_percent, y =raw_data2$target_death_rate)) + geom_point() + labs(title = "pct_poverty_percent")
dot4 = ggplot(raw_data2, aes(x  = raw_data2$pct_bach_deg25_over, y =raw_data2$target_death_rate)) + geom_point() + labs(title = "pct_pct_bach_deg25_over")
dot5 = ggplot(raw_data2, aes(x  = raw_data2$pct_unemployed16_over, y =raw_data2$target_death_rate)) + geom_point() + labs(title = "pct_unemployed16_over")
dot6 = ggplot(raw_data2, aes(x  = raw_data2$pct_public_coverage_alone, y =raw_data2$target_death_rate)) + geom_point() + labs(title = "pct_public_coverage_alone")
grid.arrange(dot1, dot2, dot3, dot4, dot5, dot6, ncol=2)
```

![](yy2926_files/figure-markdown_github/unnamed-chunk-6-1.png)

``` r
## take out outliers 
raw_data3 = raw_data2[-c(1490),]
raw_data3 = raw_data3[-c(282),]
## Two rows are outliers
```

``` r
## Plot new datasets with no outliers
dot1 = ggplot(raw_data3, aes(x  = raw_data3$target_death_rate, y =raw_data3$target_death_rate)) + geom_point() + labs(title = "pct_target_death_rate")
dot2 = ggplot(raw_data3, aes(x  = raw_data3$incidence_rate, y =raw_data3$target_death_rate)) + geom_point() + labs(title = "pct_incidence_rate")
dot3 = ggplot(raw_data3, aes(x  = raw_data3$poverty_percent, y =raw_data3$target_death_rate)) + geom_point() + labs(title = "pct_poverty_percent")
dot4 = ggplot(raw_data3, aes(x  = raw_data3$pct_bach_deg25_over, y =raw_data3$target_death_rate)) + geom_point() + labs(title = "pct_pct_bach_deg25_over")
dot5 = ggplot(raw_data3, aes(x  = raw_data3$pct_unemployed16_over, y =raw_data3$target_death_rate)) + geom_point() + labs(title = "pct_unemployed16_over")
dot6 = ggplot(raw_data3, aes(x  = raw_data3$pct_public_coverage_alone, y =raw_data3$target_death_rate)) + geom_point() + labs(title = "pct_public_coverage_alone")
grid.arrange(dot1, dot2, dot3, dot4, dot5, dot6, ncol=2)
```

![](yy2926_files/figure-markdown_github/unnamed-chunk-8-1.png)

``` r
## Descriptive statistics
summary(raw_data3)
```

    ##  target_death_rate incidence_rate  poverty_percent pct_bach_deg25_over
    ##  Min.   : 59.7     Min.   :201.3   Min.   : 3.20   Min.   : 2.50      
    ##  1st Qu.:161.2     1st Qu.:420.3   1st Qu.:12.10   1st Qu.: 9.40      
    ##  Median :178.1     Median :453.5   Median :15.90   Median :12.30      
    ##  Mean   :178.6     Mean   :447.8   Mean   :16.87   Mean   :13.28      
    ##  3rd Qu.:195.2     3rd Qu.:480.8   3rd Qu.:20.40   3rd Qu.:16.10      
    ##  Max.   :293.9     Max.   :718.9   Max.   :47.40   Max.   :42.20      
    ##  pct_unemployed16_over pct_public_coverage_alone
    ##  Min.   : 0.400        Min.   : 2.60            
    ##  1st Qu.: 5.500        1st Qu.:14.90            
    ##  Median : 7.600        Median :18.80            
    ##  Mean   : 7.851        Mean   :19.24            
    ##  3rd Qu.: 9.700        3rd Qu.:23.10            
    ##  Max.   :29.400        Max.   :46.60
